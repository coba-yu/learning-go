# 初めての Go 言語｜3章 合成型

## 3.2 スライス

宣言時に大きさを指定しないとスライスになる


```go
// スライス
var x = []int{10, 20, 30}

// [n] または [...] と書くと配列になる.
var x = [...]int{10, 20, 30}
```

スライスは比較可能ではない

```go
// x は nil に初期化されている
var x []int

// nil とだけ比較できる
// true
fmt.Println(x == nil)
```

「どうすればスライスを大きくする回数を減らせるか」に注目してスライスの生成方法を選択する.

初期値がある場合 or スライスの値が変化しない場合 => スライスリテラル

```go 
data := []int{2, 4, 6, 8}
```

実行してみるまでスライスのサイズがわからない場合 => make

大きさはどうする？

- バッファとして用いる場合 (11.1) や必要なサイズが正確にわかっている場合 => 長さを指定
- ほかの状況 => 長さ0で作成して append していく

make で作成したスライスに append すると無駄なゼロ値が並んだ部分ができてしまうので注意

## 3.3 文字列、rune、バイト

文字列の操作では、スライスやインデックスを使用するよりも、標準ライブラリのパッケージ (strings, unicode/utf8) を使った方がよい

int を型変換によって string に変換することはできない

```go
var x int = 65
var y  = string(x)
fmt.Println(y)  // A
```

## 3.4 マップ

カンマ ok イディオム -> ゼロ値が設定されているキーとマップに存在しないキー (ふつうに取得するとゼロ値になってしまう) を区別できる

```go
m := map[string]int{
	"hello": 5,
	"world": 0,
}

v, ok = m["hello"]    // ok = true
v, ok = m["world"]    // ok = true (ゼロ値が設定されているキー）
v, ok = m["goodbye"]  // ok = false (キーが存在しない)
```

マップをセットの代わりに使うこともできるがサードパーティライブラリを使った方がよさそう

## 3.5 構造体

```go
// 通常の構造体 (type をつける)
type person struct {
	name string
	age  int
	pet  string
}
var fred persion

// 無名構造体 -> 変数として直接定義？
var persion struct {
    name string
    age  int
    pet  string
}
```

無名構造体の用途
- 外部データ (e.g. JSON) と変換 -> マーシャリング/アンマーシャリング
- テーブル駆動のテスト
